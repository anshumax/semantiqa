[
  {
    "$match": {
      "$and": [
        {
          "$expr": {
            "$ne": [
              "$direction",
              null
            ]
          }
        }
      ]
    }
  },
  {
    "$group": {
      "_id": {
        "$substr": [
          "$txn_ts",
          0,
          7
        ]
      },
      "count": {
        "$sum": 1
      },
      "amount": {
        "$sum": "$amount"
      }
    }
  },
  {
    "$sort": {
      "_id": 1
    }
  }
]